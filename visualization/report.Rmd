---
title: "Leader Network Diagnostic Report"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---

```{r echo=FALSE, message=FALSE}
library(reshape)
library(plyr)
library(scales)
library(ggplot2)
library(igraph)
```

```{r echo=FALSE}
# load example data
respondent <- read.csv('../example_data/respondent.csv')
connections <- read.csv('../example_data/connections.csv')
network <- read.csv('../example_data/network.csv')
```

```{r echo=FALSE}
# convert data types where needed
connections$name <- as.character(connections$name)
connections$id <- as.character(connections$id)
```

```{r echo=FALSE, results='hide'}
# inspect data
str(respondent)
str(connections)
str(network)
```

Welcome to the results of the Leader Network Diagnostic. The purpose of this document is to help you understand your core professional network.

## Network Visualization

In this section, we are going to show you what your core professional network looks like.

```{r echo=FALSE, fig.align="center"}
# create undirected graph
g <- graph_from_data_frame(d=network, directed=F)

# calculate layout
l <- layout_with_fr(g)

# plot graph
plot(g, 
     vertex.size=25,
     vertex.color="gray",
     vertex.label.color="black",
     vertex.label.cex=0.5,
     edge.curved=.1,
     layout=l
     )
```

## Open

Openness measures the degree to which the people in your network know one another.

<center>
![](./open.png)
</center>

## Diverse

Diversity measures the degree to which the people in your network are similiar or not similiar to one another.

```{r echo=FALSE, results='hide', fig.align="center"}
# subset helpful responses
helpful <- connections[c("name", 
                         "work", 
                         "friend", 
                         "support", 
                         "career",
                         "mentoring",
                         "growth",
                         "motivator"
                         )]

#reshape the helpful data
helpful.m <- melt(helpful, id="name")

# rescale variables
helpful.m <- ddply(helpful.m, .(variable), transform, rescale = rescale(value))

# plot heatmap of name by helpful
ggplot(helpful.m, aes(variable, name)) + 
  geom_tile(aes(fill = rescale),colour = "white") + 
  scale_fill_gradient(low = "white", high = "steelblue") +
  theme(legend.title=element_blank())
```

## Deep

Depth measures the strength of the relationship you have with the people in your network.



